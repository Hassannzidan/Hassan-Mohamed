{% schema %}
{
  "name": "Products Grid",
  "blocks": [
    {
      "type": "product",
      "name": "Product Block",
      "settings": [
        {
          "type": "product",
          "id": "product",
          "label": "Select a Product"
        },
        {
          "type": "range",
          "id": "pos_x",
          "label": "X Position (%)",
          "min": 0,
          "max": 100,
          "default": 50
        },
        {
          "type": "range",
          "id": "pos_y",
          "label": "Y Position (%)",
          "min": 0,
          "max": 100,
          "default": 50
        }
      ]
    }
  ],
  "max_blocks": 6
}
{% endschema %}

<section class="products-section">
  <!-- Section Title -->
  <h2 class="section-title">Tisso vison in the wild</h2>

  <!-- Products Grid -->
  <div class="products-grid">
    {% for block in section.blocks %}
      {% assign product = all_products[block.settings.product] %}
      <div class="product-card">
        <div class="image-wrapper">
          <!-- Product Image -->
          <img
            src="{{ product.featured_image | img_url: '500x' }}"
            alt="{{ product.title }}"
            width=""
            height=""
          >

          <!-- Plus button (opens modal) -->
          <button
            class="plus-btn"
            data-handle="{{ product.handle }}"
            style="top: {{ block.settings.pos_y }}%; left: {{ block.settings.pos_top }}%;"
          >
            <svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
              <g filter="url(#filter0_d_3_2760)">
              <circle cx="15" cy="12" r="11" fill="#F8F8F8" fill-opacity="0.9"/>
              <path d="M15.3457 8.04175V16.5033" stroke="black" stroke-width="1.5" stroke-linecap="square" stroke-linejoin="round"/>
              <path d="M11.1152 12.2725H19.5768" stroke="black" stroke-width="1.5" stroke-linecap="square" stroke-linejoin="round"/>
              </g>
              <defs>
              <filter id="filter0_d_3_2760" x="0" y="0" width="30" height="30" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
              <feFlood flood-opacity="0" result="BackgroundImageFix"/>
              <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
              <feOffset dy="3"/>
              <feGaussianBlur stdDeviation="2"/>
              <feComposite in2="hardAlpha" operator="out"/>
              <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.2 0"/>
              <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_3_2760"/>
              <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_3_2760" result="shape"/>
              </filter>
              </defs>
            </svg>
          </button>
        </div>
      </div>
    {% endfor %}
  </div>

  <!-- Product Modal -->
  <div id="myModal" class="modal">
    <div class="modal-content">
      <!-- Close Button -->
      <span class="close">
        <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M5.03723 4.94354L13.5225 13.4288" stroke="black" stroke-width="1.5" stroke-linecap="square" stroke-linejoin="round"/>
          <path d="M5.03723 13.4285L13.5225 4.94325" stroke="black" stroke-width="1.5" stroke-linecap="square" stroke-linejoin="round"/>
        </svg>
      </span>

      <!-- Modal Top (Image + Basic Info) -->
      <div class="modal-top">
        <img id="modalImage" class="product-image" src="" alt="Product Image" width="" height="">

        <div class="basic-details">
          <h2 id="modalTitle"></h2>
          <p id="modalPrice"></p>
          <p id="modalDescription"></p>
        </div>
      </div>

      <!-- Modal Details -->
      <div class="modal-details">
        <!-- Colors -->
        <div class="color-options">
          <label>Color</label>
          <div id="colorContainer"></div>
        </div>

        <!-- Sizes -->
        <div class="size-options">
          <label>Size</label>
          <div class="custom-dropdown">
            <button id="sizeDropdownBtn" class="dropdown-btn">
              <span class="label">Choose your size</span>
              <span class="chevron">
                <svg width="16" height="10" viewBox="0 0 16 10" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M2 2L8 8L14 2" stroke="black" stroke-width="1.5" stroke-linecap="square"/>
                </svg>
              </span>
            </button>
            <div id="sizeDropdownList" class="dropdown-list"></div>
          </div>
        </div>
      </div>

      <!-- Add to Cart -->
      <button id="addToCartBtn">
        <span class="addToCartBtn-text">ADD TO CART</span>
        <span class="addToCartBtn-icon">
          <svg width="28" height="13" viewBox="0 0 28 13" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M1.11108 5.74396L0.361084 5.74396L0.361084 7.24396L1.11108 7.24396L1.11108 5.74396ZM27.1487 7.02429C27.4416 6.7314 27.4416 6.25652 27.1487 5.96363L22.3757 1.19066C22.0828 0.897765 21.6079 0.897765 21.315 1.19066C21.0221 1.48355 21.0221 1.95843 21.315 2.25132L25.5577 6.49396L21.315 10.7366C21.0221 11.0295 21.0221 11.5044 21.315 11.7973C21.6079 12.0902 22.0828 12.0902 22.3757 11.7973L27.1487 7.02429ZM1.11108 7.24396L26.6183 7.24396L26.6183 5.74396L1.11108 5.74396L1.11108 7.24396Z" fill="white"/>
          </svg>
        </span>
      </button>
    </div>
  </div>
</section>
{{ 'grid-style.css' | asset_url | stylesheet_tag }}
<script src="{{'grid-script.js' | asset_url}}" defer></script>